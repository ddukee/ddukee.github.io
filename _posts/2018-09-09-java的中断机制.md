---
layout: post
title:  "Java的中断机制"
date:   2018-09-09 21:04:06 +0800
categories: java
tags: java thread
published: false
---

## 什么是中断
中断，顾名思义，就是终止，打断的意思。

当我们的程序在执行过程中，如果没有外界干预，并且程序执行过程中不出错，那么程序就可以一直执行下去，直到程序结束退出。

当我们在写多线程代码的时候，因为某些原因，可能是出现了错误，我们需要让运行中的线程停下来，这个时候，中断机制就可以派上。

接下来，我将介绍在Java中是如何产生一个中断的，以及Java的中断机制。本文假设您具有Java多线程的基础知识。

## 创建一个线程	
在产生一个中断之前，我们首先需要创建一个线程。在Java中，创建线程的方式有两种。一种是通过继承`Thread`类来创建一个线程对象。
{% highlight java %}
public class MyThread extends Thread {
    @Override
    public void run() {
        // TODO target code
    }
    
    public static void main(String ...args) {
        new MyThread().start();
    }
}
{% endhighlight %}

另一种是通过实现一个`Runnable`接口来定义个任务，然后由线程去执行这个任务。
{% highlight java %}
// Task class
public class Task implement Runnable {
    public void run() {
    	// TODO taget code        
    }
    
    public static void main(String ...args) {
        new Thread(new Task()).start();
    }
}
{% endhighlight %}

## 产生一个中断

在Java中，可以通过`Thread`的成员方法`interrupt()`来对一个线程发起中断。当我们持有一个线程对象的时候，我们就可以通过`threadObject.interrupt()`来中断`threadObject`这个线程对象所指的那个线程。

{% highlight java %}
public class MyThread extends Thread {
    public MyThread(String name) {
        super(name);
    }

    @Override
    public void run() {
        try {
            Thread.sleep(1000);    // <---- ⑤
        } catch(InterruptedException ex) {  // <---- ⑥
            System.out.println(Thread.currentThread().getName() + ": Interrupted");
        }
    }

    public static void main(String ...args) throws Exception {
        Thread myThread = new MyThread("MyThread");    // <---- ①
        myThread.start();    // <---- ②
        myThread.interrupt();    // <---- ③
        myThread.join();    // <---- ④
    }
}
{% endhighlight %}

运行结果:

{% highlight bash %}
$ MyThread: Interrupted
{% endhighlight %}

上面代码就演示了一次中断过程。在①处我们首先创建了一个线程名为MyThread的线程，然后在②处我们调用它的`start()`方法启动该线程。在MyThread这个线程的`run()`方法中，我们通过`Thread.sleep(1000)`让线程挂起1秒种，目的是让我们③处的代码执行的时候，MyThread这个线程还没有执行完。在`run()`方法中，我们通过`try-catch`语句捕获一个中断异常。当③处的代码对MyThread发起一个中断以后，⑥处的catch语句会捕获这个异常，并且在终端输出中断信息。

## 何时触发中断？


